# Baby Tracker Package
# Save this file to your Home Assistant config/packages/ directory (ensure 'packages: !include_dir_named packages' is in configuration.yaml)

# ------------------------------------------------------------------------------
# INPUT DATETIMES
# ------------------------------------------------------------------------------
input_datetime:
  baby_last_poo:
    name: Ultima Cacca
    has_date: true
    has_time: true
    icon: mdi:emoticon-poop

  baby_last_pee:
    name: Ultima Pipì
    has_date: true
    has_time: true
    icon: mdi:water-outline

  baby_last_feeding_start:
    name: Inizio Ultima Poppata
    has_date: true
    has_time: true
    icon: mdi:baby-bottle

  baby_last_feeding_end:
    name: Fine Ultima Poppata
    has_date: true
    has_time: true
    icon: mdi:baby-bottle-outline

  baby_last_growth:
    name: Ultima Misurazione Crescita
    has_date: true
    has_time: true
    icon: mdi:scale-bathroom

# ------------------------------------------------------------------------------
# INPUT TEXTS / SELECTS
# ------------------------------------------------------------------------------
input_text:
  baby_last_feeding_side:
    name: Lato Ultima Poppata
    icon: mdi:format-list-bulleted
    # Expected values: 'dx', 'sx', 'both', 'bottle'

  baby_last_feeding_duration:
    name: Durata Ultima Poppata
    icon: mdi:timer-sand
    # Human readable string ex: "15 min"

# ------------------------------------------------------------------------------
# INPUT BOOLEANS
# ------------------------------------------------------------------------------
input_boolean:
  baby_feeding_timer_active:
    name: Timer Poppata Attivo
    icon: mdi:timer-outline

# ------------------------------------------------------------------------------
# INPUT NUMBERS (Growth)
# ------------------------------------------------------------------------------
input_number:
  baby_weight:
    name: Peso
    min: 0
    max: 20
    step: 0.01
    unit_of_measurement: kg
    mode: box
    icon: mdi:scale-bathroom

  baby_height:
    name: Altezza
    min: 0
    max: 120
    step: 0.5
    unit_of_measurement: cm
    mode: box
    icon: mdi:human-male-height

  baby_head_circumference:
    name: Circonferenza Testa
    min: 0
    max: 60
    step: 0.1
    unit_of_measurement: cm
    mode: box
    icon: mdi:tape-measure

# ------------------------------------------------------------------------------
# COUNTERS (Daily stats)
# ------------------------------------------------------------------------------
counter:
  baby_diaper_poo_daily:
    name: Cacche Oggi
    initial: 0
    step: 1
    icon: mdi:counter

  baby_diaper_pee_daily:
    name: Pipì Oggi
    initial: 0
    step: 1
    icon: mdi:counter

  baby_feeding_daily:
    name: Poppate Oggi
    initial: 0
    step: 1
    icon: mdi:counter

# ------------------------------------------------------------------------------
# TEMPLATE SENSORS (Optional, for UI display)
# ------------------------------------------------------------------------------
template:
  - sensor:
      - name: "Tempo dall'ultima cacca"
        unique_id: baby_time_since_last_poo
        state: >
          {% set last = states('input_datetime.baby_last_poo') %}
          {% if last not in ['unknown', 'unavailable'] %}
            {{ (as_timestamp(now()) - as_timestamp(last)) | int // 60 }} min
          {% else %}
            N/A
          {% endif %}
        unit_of_measurement: "min"

      - name: "Tempo dall'ultima poppata"
        unique_id: baby_time_since_last_feeding
        state: >
          {% set last = states('input_datetime.baby_last_feeding_end') %}
          {% if last not in ['unknown', 'unavailable'] %}
            {{ (as_timestamp(now()) - as_timestamp(last)) | int // 60 }} min
          {% else %}
            N/A
          {% endif %}
        unit_of_measurement: "min"
